<!-- client side -->

<!doctype html>
<html>

<!-- HTML HEAD -->
<head>
    <title>Smart Heating + Lighting</title>
    <!-- Source for Canvas JS - points to the web - needs internet -->
    <!-- Source for Socket.io - this one is local -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
</head>

<body>
    <!-- HTML layout -->
  <h1>Smart Heating and Lighting</h1> <br>
  <p id="heatmsg">Heat Status: </p>
  <p id="lightmsg">Light Status: </p>
    <div id="message_disp"></div>
    <!-- Script to handle socket and also to update chart datapoints -->
    <script>
    var timestamp;
    var deviceID;
    var temperature;
        var socket = io();
        socket.on('message', function(msg){
            //msg[0] = heat level from thermistor, msg[1] = light level from photoresistor, msg[2] = timestamp
            var date  = new Date();
            //date = date.toString();
            document.getElementById("heatmsg").innerHTML = "";
            document.getElementById("lightmsg").innerHTML = "";
            var print1 = "Heat Status: " + msg.temp + " C (Last Measured : " + date + " )";
            var print2 = "Light Status: " + msg.pwm + " % (Last Measured : " + date + " )";
            document.getElementById("heatmsg").innerHTML = print1;
            document.getElementById("lightmsg").innerHTML = print2;
        });
    </script>
    <script>
    function loaddata(){
        
        const Http = new XMLHttpRequest();
        const url='http://192.168.1.102:3000/water';
        Http.open("POST", url);
        Http.setRequestHeader("Content-Type", "application/json");
        Http.send(JSON.stringify({"state": "0"}));

        Http.onreadystatechange = (e) => {
        console.log(Http)
}
   /* let xhr = new XMLHttpRequest();
        xhr.open('post', '/water', true);
        xhr.responseType = 'text';
        xhr.send();
        xhr.onload = function() {
            let responseObj = xhr.response;
            dt.load(responseObj);
        };*/
}
$(document).ready(function(e) {
   
   
   
    window.setInterval(function(){
        loaddata();
    },5000);
});
    
    </script>
</body>

</html>